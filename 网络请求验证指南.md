# 🔍 网络请求验证指南

**目的**: 通过浏览器开发者工具验证药材数据是否来自真实数据库

---

## 📋 验证步骤

### 步骤1: 打开开发者工具

1. 在药材页面（Knowledge/药材选择页面）
2. 按 `F12` 或右键 → "检查"
3. 切换到 **Network**（网络）标签

---

### 步骤2: 清除缓存并重新加载

1. 在 Network 标签中，勾选 **"Disable cache"**（禁用缓存）
2. 按 `Ctrl + R` 刷新页面（强制重新请求）

---

### 步骤3: 查找药材 API 请求

在 Network 列表中查找：
- 请求名称: `medicines?page=1&limit=100` 或类似
- 类型: `xhr` 或 `fetch`
- 状态: 应该是 `200`（如果禁用了缓存）

---

### 步骤4: 查看响应内容

1. 点击 `medicines?page=1&limit=100` 请求
2. 切换到 **Response**（响应）或 **Preview**（预览）标签
3. 检查以下内容：

#### ✅ 真实数据库的特征

```json
{
  "success": true,
  "data": {
    "medicines": [
      {
        "medicine_id": "3571a734-1a20-45c2-9de8-8528a1a71613",
        "name": "五味子",
        "category": "收涩药",
        ...
      },
      {
        "medicine_id": "06d8e336-0e51-4ffa-aa9b-ddc5bca212da",
        "name": "荆芥",
        "category": "解表药",
        ...
      }
      // ... 应该有56个药材（或接近56个）
    ],
    "pagination": {
      "total": 56,  // ✅ 关键：总数应该是56
      "page": 1,
      "limit": 100
    }
  }
}
```

**判断标准**:
- ✅ `pagination.total` = **56** = 真实数据库
- ✅ `medicine_id` 是 **UUID 格式**（如 `3571a734-...`）
- ✅ 药材名称是真实的（如"五味子"、"荆芥"、"附子"等）

#### ❌ 模拟数据的特征

```json
{
  "code": 200,
  "data": {
    "list": [
      {
        "id": 1,  // ❌ 数字ID，不是UUID
        "name": "人参",
        "latinName": "Panax ginseng C. A. Mey.",
        ...
      }
      // ... 只有约20个药材
    ],
    "total": 20,  // ❌ 总数约20个
    "isMock": true  // ❌ 明确标记为模拟数据
  }
}
```

**判断标准**:
- ❌ `total` 约 **20** 个 = 模拟数据
- ❌ `id` 是 **数字**（如 1, 2, 3）
- ❌ 有 `isMock: true` 标记

---

### 步骤5: 检查分类请求

在 Network 列表中查找：
- `medicine-categories`
- `categories`
- `getCategories`

**结果**:
- ❌ **找不到这些请求** = 分类使用模拟数据（符合预期）

---

## 📊 当前状态确认

根据您的网络日志：

### ✅ 已确认

1. **药材列表 API 正在调用**
   - 请求: `medicines?page=1&limit=100`
   - 状态: 304（缓存）或 200（新请求）
   - ✅ 说明前端代码已正确接入后端 API

2. **分类 API 未调用**
   - ❌ 没有相关请求
   - ✅ 符合预期（后端未实现分类接口）

### 🔍 需要验证

**药材数据是否来自真实数据库？**

需要查看 `medicines?page=1&limit=100` 的响应内容：
- 如果 `total: 56` = ✅ 真实数据库
- 如果 `total: ~20` = ❌ 降级到模拟数据

---

## 🎯 快速验证方法

### 方法1: 查看响应大小

- **真实数据**（56个药材）: 响应大小通常 > **10 KB**
- **模拟数据**（20个药材）: 响应大小通常 < **5 KB**

您当前的 397 B 可能是缓存的压缩响应，需要查看实际响应内容。

### 方法2: 在 Console 中测试

打开 Console 标签，输入：

```javascript
// 获取药材列表
fetch('http://localhost:3000/api/medicines?page=1&limit=100')
  .then(r => r.json())
  .then(data => {
    console.log('药材总数:', data.data.pagination.total)
    console.log('前3个药材:', data.data.medicines.slice(0, 3))
  })
```

**预期输出**:
- ✅ `药材总数: 56` = 真实数据库
- ❌ `药材总数: 20` = 模拟数据

---

## 🔧 下一步建议

### 如果确认是真实数据（56个药材）

1. ✅ 药材数据接入正常
2. ⚠️ 只需解决分类接口问题

### 如果是模拟数据（约20个药材）

1. ⚠️ 检查后端 API 是否正常运行
2. ⚠️ 检查前端 API 调用是否有错误
3. ⚠️ 查看 Console 是否有错误信息

---

**验证完成后，请告诉我结果！** 🎯
