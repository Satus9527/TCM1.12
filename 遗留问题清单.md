# 遗留问题清单

**更新日期**: 2025年10月30日  
**项目**: TCM Web 中医平台后端系统

---

## 🔴 高优先级问题（需立即处理）

### 1. E1 AI服务集成未完成
- **问题**: 当前使用Mock服务，生产环境需要真实AI服务
- **影响**: AI推荐功能、WebSocket AI分析功能无法在生产环境使用
- **负责**: 后端 + 外部服务对接
- **预计时间**: 2-3天
- **依赖**: 需要AI服务提供方配合

**待配置环境变量**:
```
E1_RECOMMEND_URL=<真实AI推荐服务URL>
E1_ANALYZE_URL=<真实AI分析服务URL>
E1_TIMEOUT_MS=5000
```

---

### 2. API文档缺失
- **问题**: 无标准化的API接口文档
- **影响**: 前端开发需要查看源代码，沟通成本高
- **负责**: 后端
- **预计时间**: 2天
- **建议方案**: 
  - Swagger/OpenAPI文档
  - Postman Collection
  - Markdown API文档

---

## 🟡 中优先级问题（近期需处理）

### 3. 初始状态数据缺失
- **问题**: WebSocket连接时Redis无初始状态数据
- **影响**: 测试覆盖率、用户首次体验
- **负责**: 前端 + 后端
- **预计时间**: 1天
- **建议方案**: 前端检测空状态并引导用户

---

### 4. 测试环境依赖复杂
- **问题**: 测试需要手动启动MySQL和Redis
- **影响**: 新人上手困难，测试数据污染开发环境
- **负责**: DevOps + 后端
- **预计时间**: 2-3天
- **建议方案**: Docker Compose容器化

---

### 5. 部署文档缺失
- **问题**: 缺少生产环境部署指南
- **影响**: 运维部署困难
- **负责**: 后端 + DevOps
- **预计时间**: 2天
- **输出文档**: `DEPLOYMENT.md`

---

### 6. 知识库数据不完整
- **问题**: 当前数据量较少，生产环境需更完整数据
- **影响**: 推荐准确性和用户体验
- **负责**: 产品 + 内容团队
- **预计时间**: 持续进行
- **建议**: 与中医药专家合作扩充

---

### 7. 安全性增强
- **问题**: 缺少请求限流、CORS精细化配置、日志脱敏
- **影响**: 生产环境安全风险
- **负责**: 后端 + 安全团队
- **预计时间**: 1周
- **建议**: 安全审计 + 渗透测试

---

## 🟢 低优先级问题（可稍后处理）

### 8. Redis缓存策略优化
- **问题**: 缓存TTL固定，未根据访问模式优化
- **影响**: 性能优化空间
- **负责**: 后端
- **预计时间**: 1-2周
- **建议**: 生产环境运行后根据数据优化

---

### 9. WebSocket连接池管理
- **问题**: 缺少连接数上限保护、心跳机制
- **影响**: 高并发场景可能出现问题
- **负责**: 后端
- **预计时间**: 1周
- **建议**: 压力测试后优化

---

### 10. 单元测试覆盖不足
- **问题**: 主要完成集成测试，缺少Service层单元测试
- **影响**: 代码质量保障不足
- **负责**: 后端
- **预计时间**: 1周
- **目标**: 80%以上覆盖率

---

### 11. 代码注释不完整
- **问题**: 部分复杂逻辑缺少详细注释
- **影响**: 代码可读性
- **负责**: 后端
- **预计时间**: 3-4天
- **建议**: 添加JSDoc注释

---

### 12. 用户收藏功能未实现
- **问题**: 控制器框架已搭建，业务逻辑未实现
- **影响**: 用户体验功能缺失
- **负责**: 后端
- **预计时间**: 1-2天
- **优先级**: 根据产品需求调整

---

## ⏱️ 测试超时问题说明（非BUG）

以下测试超时是**预期行为**，不需要修复：

### AI推荐API测试
- ⏱️ E1服务真实调用超时 - **正常**（测试环境无真实AI服务）
- ⏱️ 服务降级机制触发 - **正常**（符合设计）

### WebSocket测试
- ⏱️ 接收初始状态超时 - **正常**（Redis中无历史数据）
- ⏱️ AI分析超时 - **正常**（无真实E1 AI服务）

**说明**: 这些超时在生产环境集成真实AI服务后会自动解决。

---

## 📋 快速行动计划

### 本周（Week 1）
1. 🔴 联系AI服务提供方，获取E1服务接口信息
2. 🔴 编写Swagger API文档
3. 🟡 编写Docker Compose测试环境配置

### 下周（Week 2）
1. 🔴 集成真实E1 AI服务并测试
2. 🟡 编写部署文档（`DEPLOYMENT.md`）
3. 🟡 实施基础安全增强（限流、CORS）

### 本月（Month 1）
1. 🟡 扩充知识库数据
2. 🟡 完成安全审计
3. 🟢 性能优化和监控系统搭建

---

## 📝 备注

- 优先级标识：🔴 高 | 🟡 中 | 🟢 低
- 本清单将随项目进展动态更新
- 每周五更新问题状态

**最后更新**: 2025年10月30日

