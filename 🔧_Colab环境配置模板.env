# ============================================
# TCM Platform - Colab AI 集成配置模板
# ============================================
# 说明: 此文件用于演示如何配置Colab AI服务
# 请复制到 .env 文件中并根据实际情况修改
# ============================================

# ============================================
# AI Service (E1) - Colab 云端服务配置
# ============================================
# 注意：{public_url} 需要替换为AI团队提供的实际Colab URL
# URL格式: https://xxxx-xx-xx-xxx-xxx.ngrok-free.app

# 推荐服务URL - 使用/consult端点
E1_RECOMMEND_URL=https://{AI团队提供的public_url}/consult

# 分析服务URL - 使用/consult端点（与推荐共用）
E1_ANALYZE_URL=https://{AI团队提供的public_url}/consult

# 健康检查URL
E1_HEALTH_URL=https://{AI团队提供的public_url}/health

# SLA 超时配置（毫秒）
# 注意: Colab首次请求可能较慢，如果超时频繁可增加到15000
E1_TIMEOUT_MS=5000

# 已移除: E1_API_KEY（Colab方案不使用API Key认证）
# E1_API_KEY=

# ============================================
# 其他配置（保持不变）
# ============================================

# 环境设置
NODE_ENV=production
PORT=3000

# 数据库配置 (D1, D2, D3)
DB_HOST=localhost
DB_PORT=3306
DB_USER=tcm_app_user
DB_PASSWORD=YOUR_STRONG_SECURE_PASSWORD
DB_NAME=tcm_platform

# Redis 缓存配置 (D4)
REDIS_HOST=localhost
REDIS_PORT=6379

# JWT 认证配置
JWT_SECRET=YOUR_VERY_STRONG_SECRET_KEY_HERE
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d

# D8 对象存储配置（MinIO 或 AWS S3）
D8_ENDPOINT=http://localhost:9000
D8_REGION=us-east-1
D8_BUCKET=tcm-platform-files
D8_ACCESS_KEY_ID=minioadmin
D8_SECRET_ACCESS_KEY=minioadmin
D8_FORCE_PATH_STYLE=true

# 文件上传配置
UPLOAD_MAX_FILE_SIZE=52428800
UPLOAD_ALLOWED_MIME_TYPES=application/pdf,image/jpeg,image/png,image/gif,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,video/mp4
UPLOAD_ALLOWED_EXTENSIONS=.pdf,.jpg,.jpeg,.png,.gif,.ppt,.pptx,.doc,.docx,.mp4

# 日志配置
LOG_LEVEL=info

# CORS 前端 URL
FRONTEND_URL=https://yourdomain.com

# WebSocket 配置
DEBOUNCE_MS=300

# ============================================
# 配置说明
# ============================================
#
# 关键变更:
# 1. E1_RECOMMEND_URL 和 E1_ANALYZE_URL 现在指向同一个 /consult 端点
# 2. 已移除 E1_API_KEY（Colab方案无认证）
# 3. E1_TIMEOUT_MS 保持5秒，但Colab首次请求可能超时
#
# 注意事项:
# 1. Colab URL会变化，每次AI团队重启都需要更新
# 2. Colab会话有效期约12小时
# 3. 首次请求可能较慢，后续请求较快
# 4. 不适用IP白名单（ngrok公网隧道）
#
# 部署后:
# 1. 更新此文件中的 {public_url}
# 2. 将内容复制到 .env 文件
# 3. 重启服务: pm2 restart tcm-backend
# 4. 运行测试: 查看 🧪_Colab_AI测试指南.md
#

